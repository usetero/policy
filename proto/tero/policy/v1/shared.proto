syntax = "proto3";

package tero.policy.v1;

option go_package = "github.com/usetero/policy/gen/go/tero/policy/v1";

// =============================================================================
// Shared Types
// =============================================================================

// AttributePath specifies how to access an attribute value.
//
// The path is represented as an array of string segments. Each segment represents
// a key to traverse into nested maps.
//
// Example usage:
//
//   For an attribute structure like:
//     Attributes: map[string]any{
//         "http": map[string]any{
//             "method":      "POST",
//             "status_code": 200,
//         },
//         "user_id": "u123",
//     }
//
//   - To access "user_id": ["user_id"]
//   - To access http.method: ["http", "method"]
//
// YAML/JSON Unmarshaling:
//
// Implementations MUST accept both the canonical proto form and shorthand forms
// for ergonomic policy authoring:
//
//   Canonical (proto-native):
//     log_attribute:
//       path: ["http", "method"]
//
//   Shorthand array (MUST be supported):
//     log_attribute: ["http", "method"]
//
//   Shorthand string (MUST be supported for single-segment paths):
//     log_attribute: "user_id"           # equivalent to ["user_id"]
//
// When marshaling, implementations SHOULD use the shorthand array form for
// cleaner output.
message AttributePath {
  // Path segments for attribute traversal.
  // A single-element array accesses a flat attribute.
  // Multiple elements traverse nested maps.
  repeated string path = 1;
}
