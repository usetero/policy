syntax = "proto3";

package tero.policy.v1;

import "google/protobuf/duration.proto";

option go_package = "github.com/usetero/policy/gen/go/tero/policy/v1";

// =============================================================================
// Keep Configuration
// =============================================================================

// KeepStrategy defines simple keep/drop strategies.
enum KeepStrategy {
  KEEP_STRATEGY_UNSPECIFIED = 0;
  KEEP_STRATEGY_ALL = 1;  // Keep all matching telemetry
  KEEP_STRATEGY_NONE = 2; // Drop all matching telemetry
}

// KeepConfig defines how telemetry should be sampled/kept.
message KeepConfig {
  oneof config {
    // Simple strategy (all or none)
    KeepStrategy strategy = 1;

    // Percentage to keep (0.0 to 100.0)
    double percent = 2;

    // Rate limit
    KeepLimit limit = 3;
  }
}

// KeepLimit keeps up to a limit of matching telemetry within a time window.
message KeepLimit {
  // Maximum number of items to keep
  uint64 count = 1;

  // Time window for the limit
  google.protobuf.Duration window = 2;
}
