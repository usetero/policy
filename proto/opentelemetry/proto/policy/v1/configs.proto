syntax = "proto3";

package opentelemetry.proto.policy.v1;

import "opentelemetry/proto/policy/v1/common.proto";

option go_package = "github.com/open-telemetry/opentelemetry-proto/gen/go/policy/v1";
option java_multiple_files = true;
option java_package = "io.opentelemetry.proto.policy.v1";

// =============================================================================
// Policy Type Configurations
// =============================================================================

// FilterAction specifies what to do with matched logs.
enum FilterAction {
  FILTER_ACTION_UNSPECIFIED = 0;
  FILTER_ACTION_KEEP = 1;
  FILTER_ACTION_DROP = 2;
}

// LogFilterConfig defines configuration for log filter policies.
// Matches logs based on conditions and keeps or drops them.
message LogFilterConfig {
  // Matchers to identify which logs this filter applies to (AND logic)
  repeated LogMatcher matchers = 1;

  // Action to take on matched logs
  FilterAction action = 2;
}

// LogTrimConfig defines configuration for log trim policies.
// Matches logs based on conditions and removes specific fields.
message LogTrimConfig {
  // Matchers to identify which logs this trim applies to (AND logic)
  repeated LogMatcher matchers = 1;

  // The fields to remove from the log
  repeated LogFieldSelector fields = 2;
}
