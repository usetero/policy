{
  "id": "redact-email-keep-domain",
  "name": "Redact Email Keep Domain",
  "description": "Mask email addresses in log body while preserving the domain",
  "priority": 90,
  "enabled": true,
  "log_transform": {
    "matchers": [
      {
        "log_body": {
          "regex": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
        }
      }
    ],
    "field": {
      "log_body": {}
    },
    "replacement": {
      "pattern": "[a-zA-Z0-9._%+-]+@([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})",
      "replacement": "[REDACTED]@$1"
    }
  }
}
