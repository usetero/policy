id: payment-api-redact-transaction-logged
name: Redact transaction logged events

log:
  match:
    - field:
        log_attribute: resource.service.name
      exact: payment-api
    - field:
        log_field: body
      regex: "transaction logged"
  transform:
    redact:
      - field:
          log_attribute: card_number
      - field:
          log_attribute: account_id
