id: prod-payment-policy
name: Production payment service log policy
description: |
  Comprehensive policy for payment service logs in production.
  Keeps only errors and warnings, redacts all PII, normalizes field names.

log:
  match:
    resource.service.name: payment-api
    resource.deployment.environment: production
    not:severity_text: DEBUG
    not:severity_text: INFO
  transform:
    remove:
      - attributes.debug_context
    redact:
      - field: attributes.credit_card
      - field: attributes.cvv
      - field: attributes.account_number
      - field: body
        replacement: "[REDACTED_BODY]"
    rename:
      - from: attributes.cc_last4
        to: attributes.card_last_four
    add:
      - field: attributes.compliance
        value: pci-dss
